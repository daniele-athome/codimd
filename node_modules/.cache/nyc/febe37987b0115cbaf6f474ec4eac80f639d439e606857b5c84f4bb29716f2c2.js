var cov_1hpv8vbols=function(){var path="/home/travis/build/daniele-athome/codimd/lib/ot/server.js";var hash="8732d00ac735b25da006b96d206723c2b279e6c8";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/travis/build/daniele-athome/codimd/lib/ot/server.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:33}},"1":{start:{line:3,column:0},end:{line:5,column:1}},"2":{start:{line:4,column:11},end:{line:4,column:13}},"3":{start:{line:7,column:0},end:{line:48,column:9}},"4":{start:{line:13,column:4},end:{line:13,column:29}},"5":{start:{line:14,column:4},end:{line:14,column:39}},"6":{start:{line:18,column:2},end:{line:44,column:4}},"7":{start:{line:19,column:4},end:{line:21,column:5}},"8":{start:{line:20,column:6},end:{line:20,column:59}},"9":{start:{line:24,column:31},end:{line:24,column:62}},"10":{start:{line:27,column:20},end:{line:27,column:51}},"11":{start:{line:28,column:4},end:{line:30,column:5}},"12":{start:{line:28,column:17},end:{line:28,column:18}},"13":{start:{line:29,column:6},end:{line:29,column:67}},"14":{start:{line:33,column:22},end:{line:33,column:52}},"15":{start:{line:35,column:4},end:{line:36,column:15}},"16":{start:{line:36,column:8},end:{line:36,column:15}},"17":{start:{line:37,column:4},end:{line:37,column:32}},"18":{start:{line:39,column:4},end:{line:39,column:36}},"19":{start:{line:43,column:4},end:{line:43,column:21}},"20":{start:{line:46,column:2},end:{line:46,column:16}},"21":{start:{line:50,column:0},end:{line:52,column:1}},"22":{start:{line:51,column:2},end:{line:51,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:13},end:{line:7,column:14}},loc:{start:{line:7,column:31},end:{line:48,column:1}},line:7},"1":{name:"Server",decl:{start:{line:12,column:11},end:{line:12,column:17}},loc:{start:{line:12,column:41},end:{line:15,column:3}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:18,column:38},end:{line:18,column:39}},loc:{start:{line:18,column:69},end:{line:44,column:3}},line:18}},branchMap:{"0":{loc:{start:{line:3,column:0},end:{line:5,column:1}},type:"if",locations:[{start:{line:3,column:0},end:{line:5,column:1}},{start:{line:3,column:0},end:{line:5,column:1}}],line:3},"1":{loc:{start:{line:14,column:22},end:{line:14,column:38}},type:"binary-expr",locations:[{start:{line:14,column:22},end:{line:14,column:32}},{start:{line:14,column:36},end:{line:14,column:38}}],line:14},"2":{loc:{start:{line:19,column:4},end:{line:21,column:5}},type:"if",locations:[{start:{line:19,column:4},end:{line:21,column:5}},{start:{line:19,column:4},end:{line:21,column:5}}],line:19},"3":{loc:{start:{line:19,column:8},end:{line:19,column:57}},type:"binary-expr",locations:[{start:{line:19,column:8},end:{line:19,column:20}},{start:{line:19,column:24},end:{line:19,column:57}}],line:19},"4":{loc:{start:{line:35,column:4},end:{line:36,column:15}},type:"if",locations:[{start:{line:35,column:4},end:{line:36,column:15}},{start:{line:35,column:4},end:{line:36,column:15}}],line:35},"5":{loc:{start:{line:35,column:7},end:{line:35,column:97}},type:"binary-expr",locations:[{start:{line:35,column:7},end:{line:35,column:52}},{start:{line:35,column:56},end:{line:35,column:97}}],line:35},"6":{loc:{start:{line:50,column:0},end:{line:52,column:1}},type:"if",locations:[{start:{line:50,column:0},end:{line:52,column:1}},{start:{line:50,column:0},end:{line:52,column:1}}],line:50}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"8732d00ac735b25da006b96d206723c2b279e6c8"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var config=(cov_1hpv8vbols.s[0]++,require('../config'));cov_1hpv8vbols.s[1]++;if(typeof ot==='undefined'){cov_1hpv8vbols.b[0][0]++;var ot=(cov_1hpv8vbols.s[2]++,{});}else{cov_1hpv8vbols.b[0][1]++;}cov_1hpv8vbols.s[3]++;ot.Server=function(global){'use strict';// Constructor. Takes the current document as a string and optionally the array
// of all operations.
cov_1hpv8vbols.f[0]++;function Server(document,operations){cov_1hpv8vbols.f[1]++;cov_1hpv8vbols.s[4]++;this.document=document;cov_1hpv8vbols.s[5]++;this.operations=(cov_1hpv8vbols.b[1][0]++,operations)||(cov_1hpv8vbols.b[1][1]++,[]);}// Call this method whenever you receive an operation from a client.
cov_1hpv8vbols.s[6]++;Server.prototype.receiveOperation=function(revision,operation){cov_1hpv8vbols.f[2]++;cov_1hpv8vbols.s[7]++;if((cov_1hpv8vbols.b[3][0]++,revision<0)||(cov_1hpv8vbols.b[3][1]++,this.operations.length<revision)){cov_1hpv8vbols.b[2][0]++;cov_1hpv8vbols.s[8]++;throw new Error("operation revision not in history");}else{cov_1hpv8vbols.b[2][1]++;}// Find all operations that the client didn't know of when it sent the
// operation ...
var concurrentOperations=(cov_1hpv8vbols.s[9]++,this.operations.slice(revision));// ... and transform the operation against all these operations ...
var transform=(cov_1hpv8vbols.s[10]++,operation.constructor.transform);cov_1hpv8vbols.s[11]++;for(var i=(cov_1hpv8vbols.s[12]++,0);i<concurrentOperations.length;i++){cov_1hpv8vbols.s[13]++;operation=transform(operation,concurrentOperations[i])[0];}// ... and apply that on the document.
var newDocument=(cov_1hpv8vbols.s[14]++,operation.apply(this.document));// ignore if exceed the max length of document
cov_1hpv8vbols.s[15]++;if((cov_1hpv8vbols.b[5][0]++,newDocument.length>config.documentMaxLength)&&(cov_1hpv8vbols.b[5][1]++,newDocument.length>this.document.length)){cov_1hpv8vbols.b[4][0]++;cov_1hpv8vbols.s[16]++;return;}else{cov_1hpv8vbols.b[4][1]++;}cov_1hpv8vbols.s[17]++;this.document=newDocument;// Store operation in history.
cov_1hpv8vbols.s[18]++;this.operations.push(operation);// It's the caller's responsibility to send the operation to all connected
// clients and an acknowledgement to the creator.
cov_1hpv8vbols.s[19]++;return operation;};cov_1hpv8vbols.s[20]++;return Server;}(this);cov_1hpv8vbols.s[21]++;if(typeof module==='object'){cov_1hpv8vbols.b[6][0]++;cov_1hpv8vbols.s[22]++;module.exports=ot.Server;}else{cov_1hpv8vbols.b[6][1]++;}