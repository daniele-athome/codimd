'use strict';var cov_linixbpzt=function(){var path="/home/travis/build/daniele-athome/codimd/lib/config/index.js";var hash="2a519cc9032a80f86145b995a372246c48a494f3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/travis/build/daniele-athome/codimd/lib/config/index.js",statementMap:{"0":{start:{line:4,column:15},end:{line:4,column:32}},"1":{start:{line:5,column:11},end:{line:5,column:24}},"2":{start:{line:6,column:13},end:{line:6,column:28}},"3":{start:{line:7,column:18},end:{line:7,column:35}},"4":{start:{line:8,column:19},end:{line:8,column:41}},"5":{start:{line:9,column:36},end:{line:9,column:53}},"6":{start:{line:10,column:15},end:{line:10,column:35}},"7":{start:{line:11,column:39},end:{line:11,column:57}},"8":{start:{line:13,column:20},end:{line:13,column:53}},"9":{start:{line:14,column:12},end:{line:14,column:59}},"10":{start:{line:15,column:20},end:{line:17,column:1}},"11":{start:{line:20,column:32},end:{line:20,column:79}},"12":{start:{line:22,column:17},end:{line:22,column:42}},"13":{start:{line:23,column:18},end:{line:23,column:67}},"14":{start:{line:24,column:20},end:{line:24,column:65}},"15":{start:{line:26,column:22},end:{line:31,column:1}},"16":{start:{line:33,column:23},end:{line:34,column:14}},"17":{start:{line:35,column:19},end:{line:35,column:91}},"18":{start:{line:37,column:13},end:{line:37,column:33}},"19":{start:{line:38,column:0},end:{line:38,column:38}},"20":{start:{line:39,column:0},end:{line:39,column:26}},"21":{start:{line:40,column:0},end:{line:40,column:28}},"22":{start:{line:41,column:0},end:{line:41,column:25}},"23":{start:{line:42,column:0},end:{line:42,column:39}},"24":{start:{line:43,column:0},end:{line:43,column:40}},"25":{start:{line:45,column:0},end:{line:49,column:1}},"26":{start:{line:46,column:2},end:{line:46,column:32}},"27":{start:{line:48,column:2},end:{line:48,column:155}},"28":{start:{line:52,column:0},end:{line:64,column:1}},"29":{start:{line:53,column:33},end:{line:53,column:61}},"30":{start:{line:54,column:20},end:{line:54,column:22}},"31":{start:{line:55,column:2},end:{line:59,column:3}},"32":{start:{line:56,column:4},end:{line:58,column:5}},"33":{start:{line:57,column:6},end:{line:57,column:49}},"34":{start:{line:60,column:21},end:{line:62,column:3}},"35":{start:{line:63,column:2},end:{line:63,column:114}},"36":{start:{line:67,column:0},end:{line:67,column:30}},"37":{start:{line:68,column:24},end:{line:68,column:50}},"38":{start:{line:69,column:0},end:{line:76,column:1}},"39":{start:{line:70,column:2},end:{line:70,column:33}},"40":{start:{line:71,column:2},end:{line:71,column:35}},"41":{start:{line:72,column:2},end:{line:72,column:33}},"42":{start:{line:73,column:2},end:{line:73,column:47}},"43":{start:{line:74,column:7},end:{line:76,column:1}},"44":{start:{line:75,column:2},end:{line:75,column:33}},"45":{start:{line:77,column:0},end:{line:79,column:1}},"46":{start:{line:78,column:2},end:{line:78,column:46}},"47":{start:{line:82,column:0},end:{line:84,column:4}},"48":{start:{line:83,column:2},end:{line:83,column:45}},"49":{start:{line:85,column:0},end:{line:87,column:4}},"50":{start:{line:86,column:2},end:{line:86,column:45}},"51":{start:{line:90,column:0},end:{line:105,column:4}},"52":{start:{line:91,column:12},end:{line:91,column:14}},"53":{start:{line:92,column:2},end:{line:100,column:3}},"54":{start:{line:93,column:19},end:{line:93,column:65}},"55":{start:{line:94,column:4},end:{line:94,column:34}},"56":{start:{line:95,column:4},end:{line:99,column:5}},"57":{start:{line:96,column:6},end:{line:98,column:7}},"58":{start:{line:97,column:8},end:{line:97,column:32}},"59":{start:{line:101,column:2},end:{line:103,column:3}},"60":{start:{line:102,column:4},end:{line:102,column:31}},"61":{start:{line:104,column:2},end:{line:104,column:12}},"62":{start:{line:107,column:0},end:{line:109,column:1}},"63":{start:{line:108,column:2},end:{line:108,column:247}},"64":{start:{line:111,column:0},end:{line:111,column:32}},"65":{start:{line:114,column:0},end:{line:114,column:82}},"66":{start:{line:115,column:0},end:{line:115,column:76}},"67":{start:{line:116,column:0},end:{line:116,column:79}},"68":{start:{line:117,column:0},end:{line:117,column:84}},"69":{start:{line:118,column:0},end:{line:118,column:35}},"70":{start:{line:119,column:0},end:{line:119,column:37}},"71":{start:{line:120,column:0},end:{line:120,column:76}},"72":{start:{line:121,column:0},end:{line:121,column:85}},"73":{start:{line:122,column:0},end:{line:122,column:76}},"74":{start:{line:123,column:0},end:{line:123,column:88}},"75":{start:{line:124,column:0},end:{line:124,column:37}},"76":{start:{line:125,column:0},end:{line:125,column:43}},"77":{start:{line:126,column:0},end:{line:126,column:76}},"78":{start:{line:127,column:0},end:{line:127,column:48}},"79":{start:{line:130,column:0},end:{line:133,column:1}},"80":{start:{line:131,column:2},end:{line:131,column:145}},"81":{start:{line:132,column:2},end:{line:132,column:30}},"82":{start:{line:135,column:0},end:{line:135,column:112}},"83":{start:{line:138,column:0},end:{line:138,column:58}},"84":{start:{line:141,column:13},end:{line:141,column:32}},"85":{start:{line:142,column:18},end:{line:142,column:25}},"86":{start:{line:143,column:0},end:{line:155,column:1}},"87":{start:{line:143,column:13},end:{line:143,column:24}},"88":{start:{line:144,column:23},end:{line:144,column:44}},"89":{start:{line:149,column:2},end:{line:154,column:3}},"90":{start:{line:152,column:4},end:{line:152,column:169}},"91":{start:{line:153,column:4},end:{line:153,column:42}},"92":{start:{line:158,column:0},end:{line:160,column:1}},"93":{start:{line:159,column:2},end:{line:159,column:233}},"94":{start:{line:163,column:0},end:{line:168,column:1}},"95":{start:{line:164,column:2},end:{line:164,column:149}},"96":{start:{line:165,column:2},end:{line:167,column:38}},"97":{start:{line:171,column:0},end:{line:174,column:1}},"98":{start:{line:172,column:2},end:{line:172,column:164}},"99":{start:{line:173,column:2},end:{line:173,column:39}},"100":{start:{line:177,column:0},end:{line:194,column:1}},"101":{start:{line:179,column:4},end:{line:184,column:5}},"102":{start:{line:185,column:4},end:{line:185,column:9}},"103":{start:{line:187,column:4},end:{line:193,column:5}},"104":{start:{line:197,column:0},end:{line:199,column:2}},"105":{start:{line:198,column:2},end:{line:198,column:46}},"106":{start:{line:201,column:0},end:{line:201,column:32}},"107":{start:{line:202,column:0},end:{line:202,column:66}},"108":{start:{line:203,column:0},end:{line:203,column:64}},"109":{start:{line:204,column:0},end:{line:204,column:66}},"110":{start:{line:205,column:0},end:{line:205,column:60}},"111":{start:{line:206,column:0},end:{line:206,column:58}},"112":{start:{line:207,column:0},end:{line:207,column:74}},"113":{start:{line:208,column:0},end:{line:208,column:60}},"114":{start:{line:209,column:0},end:{line:209,column:66}},"115":{start:{line:212,column:0},end:{line:212,column:27}},"116":{start:{line:214,column:0},end:{line:214,column:23}}},fnMap:{"0":{name:"isStandardHTTPsPort",decl:{start:{line:82,column:39},end:{line:82,column:58}},loc:{start:{line:82,column:62},end:{line:84,column:1}},line:82},"1":{name:"isStandardHTTPPort",decl:{start:{line:85,column:38},end:{line:85,column:56}},loc:{start:{line:85,column:60},end:{line:87,column:1}},line:85},"2":{name:"getserverurl",decl:{start:{line:90,column:29},end:{line:90,column:41}},loc:{start:{line:90,column:45},end:{line:105,column:1}},line:90},"3":{name:"(anonymous_3)",decl:{start:{line:197,column:25},end:{line:197,column:26}},loc:{start:{line:197,column:53},end:{line:199,column:1}},line:197}},branchMap:{"0":{loc:{start:{line:14,column:12},end:{line:14,column:59}},type:"binary-expr",locations:[{start:{line:14,column:12},end:{line:14,column:32}},{start:{line:14,column:36},end:{line:14,column:59}}],line:14},"1":{loc:{start:{line:23,column:47},end:{line:23,column:66}},type:"binary-expr",locations:[{start:{line:23,column:47},end:{line:23,column:55}},{start:{line:23,column:59},end:{line:23,column:66}}],line:23},"2":{loc:{start:{line:24,column:20},end:{line:24,column:65}},type:"cond-expr",locations:[{start:{line:24,column:31},end:{line:24,column:55}},{start:{line:24,column:58},end:{line:24,column:65}}],line:24},"3":{loc:{start:{line:33,column:49},end:{line:34,column:13}},type:"binary-expr",locations:[{start:{line:33,column:49},end:{line:33,column:76}},{start:{line:34,column:0},end:{line:34,column:13}}],line:33},"4":{loc:{start:{line:35,column:19},end:{line:35,column:91}},type:"cond-expr",locations:[{start:{line:35,column:51},end:{line:35,column:79}},{start:{line:35,column:82},end:{line:35,column:91}}],line:35},"5":{loc:{start:{line:45,column:0},end:{line:49,column:1}},type:"if",locations:[{start:{line:45,column:0},end:{line:49,column:1}},{start:{line:45,column:0},end:{line:49,column:1}}],line:45},"6":{loc:{start:{line:52,column:0},end:{line:64,column:1}},type:"if",locations:[{start:{line:52,column:0},end:{line:64,column:1}},{start:{line:52,column:0},end:{line:64,column:1}}],line:52},"7":{loc:{start:{line:56,column:4},end:{line:58,column:5}},type:"if",locations:[{start:{line:56,column:4},end:{line:58,column:5}},{start:{line:56,column:4},end:{line:58,column:5}}],line:56},"8":{loc:{start:{line:63,column:27},end:{line:63,column:114}},type:"cond-expr",locations:[{start:{line:63,column:52},end:{line:63,column:101}},{start:{line:63,column:104},end:{line:63,column:114}}],line:63},"9":{loc:{start:{line:69,column:0},end:{line:76,column:1}},type:"if",locations:[{start:{line:69,column:0},end:{line:76,column:1}},{start:{line:69,column:0},end:{line:76,column:1}}],line:69},"10":{loc:{start:{line:69,column:4},end:{line:69,column:57}},type:"binary-expr",locations:[{start:{line:69,column:4},end:{line:69,column:26}},{start:{line:69,column:30},end:{line:69,column:57}}],line:69},"11":{loc:{start:{line:74,column:7},end:{line:76,column:1}},type:"if",locations:[{start:{line:74,column:7},end:{line:76,column:1}},{start:{line:74,column:7},end:{line:76,column:1}}],line:74},"12":{loc:{start:{line:74,column:11},end:{line:74,column:64}},type:"binary-expr",locations:[{start:{line:74,column:11},end:{line:74,column:33}},{start:{line:74,column:37},end:{line:74,column:64}}],line:74},"13":{loc:{start:{line:77,column:0},end:{line:79,column:1}},type:"if",locations:[{start:{line:77,column:0},end:{line:79,column:1}},{start:{line:77,column:0},end:{line:79,column:1}}],line:77},"14":{loc:{start:{line:83,column:9},end:{line:83,column:45}},type:"binary-expr",locations:[{start:{line:83,column:9},end:{line:83,column:22}},{start:{line:83,column:26},end:{line:83,column:45}}],line:83},"15":{loc:{start:{line:86,column:9},end:{line:86,column:45}},type:"binary-expr",locations:[{start:{line:86,column:9},end:{line:86,column:23}},{start:{line:86,column:27},end:{line:86,column:45}}],line:86},"16":{loc:{start:{line:92,column:2},end:{line:100,column:3}},type:"if",locations:[{start:{line:92,column:2},end:{line:100,column:3}},{start:{line:92,column:2},end:{line:100,column:3}}],line:92},"17":{loc:{start:{line:93,column:19},end:{line:93,column:65}},type:"cond-expr",locations:[{start:{line:93,column:43},end:{line:93,column:53}},{start:{line:93,column:56},end:{line:93,column:65}}],line:93},"18":{loc:{start:{line:95,column:4},end:{line:99,column:5}},type:"if",locations:[{start:{line:95,column:4},end:{line:99,column:5}},{start:{line:95,column:4},end:{line:99,column:5}}],line:95},"19":{loc:{start:{line:96,column:6},end:{line:98,column:7}},type:"if",locations:[{start:{line:96,column:6},end:{line:98,column:7}},{start:{line:96,column:6},end:{line:98,column:7}}],line:96},"20":{loc:{start:{line:96,column:10},end:{line:96,column:67}},type:"binary-expr",locations:[{start:{line:96,column:10},end:{line:96,column:36}},{start:{line:96,column:40},end:{line:96,column:67}}],line:96},"21":{loc:{start:{line:101,column:2},end:{line:103,column:3}},type:"if",locations:[{start:{line:101,column:2},end:{line:103,column:3}},{start:{line:101,column:2},end:{line:103,column:3}}],line:101},"22":{loc:{start:{line:107,column:0},end:{line:109,column:1}},type:"if",locations:[{start:{line:107,column:0},end:{line:109,column:1}},{start:{line:107,column:0},end:{line:109,column:1}}],line:107},"23":{loc:{start:{line:114,column:26},end:{line:114,column:82}},type:"binary-expr",locations:[{start:{line:114,column:26},end:{line:114,column:50}},{start:{line:114,column:54},end:{line:114,column:82}}],line:114},"24":{loc:{start:{line:115,column:24},end:{line:115,column:76}},type:"binary-expr",locations:[{start:{line:115,column:24},end:{line:115,column:46}},{start:{line:115,column:50},end:{line:115,column:76}}],line:115},"25":{loc:{start:{line:116,column:25},end:{line:116,column:79}},type:"binary-expr",locations:[{start:{line:116,column:25},end:{line:116,column:48}},{start:{line:116,column:52},end:{line:116,column:79}}],line:116},"26":{loc:{start:{line:117,column:25},end:{line:117,column:84}},type:"binary-expr",locations:[{start:{line:117,column:25},end:{line:117,column:51}},{start:{line:117,column:55},end:{line:117,column:84}}],line:117},"27":{loc:{start:{line:120,column:24},end:{line:120,column:76}},type:"binary-expr",locations:[{start:{line:120,column:24},end:{line:120,column:46}},{start:{line:120,column:50},end:{line:120,column:76}}],line:120},"28":{loc:{start:{line:121,column:27},end:{line:121,column:85}},type:"binary-expr",locations:[{start:{line:121,column:27},end:{line:121,column:52}},{start:{line:121,column:56},end:{line:121,column:85}}],line:121},"29":{loc:{start:{line:122,column:24},end:{line:122,column:76}},type:"binary-expr",locations:[{start:{line:122,column:24},end:{line:122,column:46}},{start:{line:122,column:50},end:{line:122,column:76}}],line:122},"30":{loc:{start:{line:123,column:28},end:{line:123,column:88}},type:"binary-expr",locations:[{start:{line:123,column:28},end:{line:123,column:54}},{start:{line:123,column:58},end:{line:123,column:88}}],line:123},"31":{loc:{start:{line:126,column:24},end:{line:126,column:76}},type:"binary-expr",locations:[{start:{line:126,column:24},end:{line:126,column:46}},{start:{line:126,column:50},end:{line:126,column:76}}],line:126},"32":{loc:{start:{line:130,column:0},end:{line:133,column:1}},type:"if",locations:[{start:{line:130,column:0},end:{line:133,column:1}},{start:{line:130,column:0},end:{line:133,column:1}}],line:130},"33":{loc:{start:{line:130,column:4},end:{line:130,column:85}},type:"binary-expr",locations:[{start:{line:130,column:4},end:{line:130,column:17}},{start:{line:130,column:21},end:{line:130,column:51}},{start:{line:130,column:55},end:{line:130,column:85}}],line:130},"34":{loc:{start:{line:135,column:32},end:{line:135,column:112}},type:"binary-expr",locations:[{start:{line:135,column:33},end:{line:135,column:53}},{start:{line:135,column:57},end:{line:135,column:86}},{start:{line:135,column:91},end:{line:135,column:112}}],line:135},"35":{loc:{start:{line:149,column:2},end:{line:154,column:3}},type:"if",locations:[{start:{line:149,column:2},end:{line:154,column:3}},{start:{line:149,column:2},end:{line:154,column:3}}],line:149},"36":{loc:{start:{line:149,column:6},end:{line:151,column:35}},type:"binary-expr",locations:[{start:{line:149,column:6},end:{line:149,column:29}},{start:{line:150,column:2},end:{line:150,column:36}},{start:{line:151,column:2},end:{line:151,column:35}}],line:149},"37":{loc:{start:{line:158,column:0},end:{line:160,column:1}},type:"if",locations:[{start:{line:158,column:0},end:{line:160,column:1}},{start:{line:158,column:0},end:{line:160,column:1}}],line:158},"38":{loc:{start:{line:163,column:0},end:{line:168,column:1}},type:"if",locations:[{start:{line:163,column:0},end:{line:168,column:1}},{start:{line:163,column:0},end:{line:168,column:1}}],line:163},"39":{loc:{start:{line:171,column:0},end:{line:174,column:1}},type:"if",locations:[{start:{line:171,column:0},end:{line:174,column:1}},{start:{line:171,column:0},end:{line:174,column:1}}],line:171},"40":{loc:{start:{line:177,column:0},end:{line:194,column:1}},type:"switch",locations:[{start:{line:178,column:2},end:{line:185,column:9}},{start:{line:186,column:2},end:{line:193,column:5}}],line:177}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0,0],"34":[0,0,0],"35":[0,0],"36":[0,0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"2a519cc9032a80f86145b995a372246c48a494f3"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();const crypto=(cov_linixbpzt.s[0]++,require('crypto'));const fs=(cov_linixbpzt.s[1]++,require('fs'));const path=(cov_linixbpzt.s[2]++,require('path'));const{merge}=(cov_linixbpzt.s[3]++,require('lodash'));const deepFreeze=(cov_linixbpzt.s[4]++,require('deep-freeze'));const{Environment,Permission}=(cov_linixbpzt.s[5]++,require('./enum'));const logger=(cov_linixbpzt.s[6]++,require('../logger'));const{getGitCommit,getGitHubURL}=(cov_linixbpzt.s[7]++,require('./utils'));const appRootPath=(cov_linixbpzt.s[8]++,path.resolve(__dirname,'../../'));const env=(cov_linixbpzt.s[9]++,(cov_linixbpzt.b[0][0]++,process.env.NODE_ENV)||(cov_linixbpzt.b[0][1]++,Environment.development));const debugConfig=(cov_linixbpzt.s[10]++,{debug:env===Environment.development// Get version string from package.json
});const{version,repository}=(cov_linixbpzt.s[11]++,require(path.join(appRootPath,'package.json')));const commitID=(cov_linixbpzt.s[12]++,getGitCommit(appRootPath));const sourceURL=(cov_linixbpzt.s[13]++,getGitHubURL(repository.url,(cov_linixbpzt.b[1][0]++,commitID)||(cov_linixbpzt.b[1][1]++,version)));const fullversion=(cov_linixbpzt.s[14]++,commitID?(cov_linixbpzt.b[2][0]++,`${version}-${commitID}`):(cov_linixbpzt.b[2][1]++,version));const packageConfig=(cov_linixbpzt.s[15]++,{version:version,minimumCompatibleVersion:'0.5.0',fullversion:fullversion,sourceURL:sourceURL});const configFilePath=(cov_linixbpzt.s[16]++,path.resolve(appRootPath,(cov_linixbpzt.b[3][0]++,process.env.CMD_CONFIG_FILE)||(cov_linixbpzt.b[3][1]++,'config.json')));const fileConfig=(cov_linixbpzt.s[17]++,fs.existsSync(configFilePath)?(cov_linixbpzt.b[4][0]++,require(configFilePath)[env]):(cov_linixbpzt.b[4][1]++,undefined));let config=(cov_linixbpzt.s[18]++,require('./default'));cov_linixbpzt.s[19]++;merge(config,require('./defaultSSL'));cov_linixbpzt.s[20]++;merge(config,debugConfig);cov_linixbpzt.s[21]++;merge(config,packageConfig);cov_linixbpzt.s[22]++;merge(config,fileConfig);cov_linixbpzt.s[23]++;merge(config,require('./environment'));cov_linixbpzt.s[24]++;merge(config,require('./dockerSecret'));cov_linixbpzt.s[25]++;if(['debug','verbose','info','warn','error'].includes(config.loglevel)){cov_linixbpzt.b[5][0]++;cov_linixbpzt.s[26]++;logger.level=config.loglevel;}else{cov_linixbpzt.b[5][1]++;cov_linixbpzt.s[27]++;logger.error('Selected loglevel %s doesn\'t exist, using default level \'debug\'. Available options: debug, verbose, info, warn, error',config.loglevel);}// load LDAP CA
cov_linixbpzt.s[28]++;if(config.ldap.tlsca){cov_linixbpzt.b[6][0]++;const certificateAuthorities=(cov_linixbpzt.s[29]++,config.ldap.tlsca.split(','));const caContent=(cov_linixbpzt.s[30]++,[]);cov_linixbpzt.s[31]++;for(const ca of certificateAuthorities){cov_linixbpzt.s[32]++;if(fs.existsSync(ca)){cov_linixbpzt.b[7][0]++;cov_linixbpzt.s[33]++;caContent.push(fs.readFileSync(ca,'utf8'));}else{cov_linixbpzt.b[7][1]++;}}const tlsOptions=(cov_linixbpzt.s[34]++,{ca:caContent});cov_linixbpzt.s[35]++;config.ldap.tlsOptions=config.ldap.tlsOptions?(cov_linixbpzt.b[8][0]++,Object.assign(config.ldap.tlsOptions,tlsOptions)):(cov_linixbpzt.b[8][1]++,tlsOptions);}else{cov_linixbpzt.b[6][1]++;}// Permission
cov_linixbpzt.s[36]++;config.permission=Permission;let defaultPermission=(cov_linixbpzt.s[37]++,config.permission.editable);cov_linixbpzt.s[38]++;if((cov_linixbpzt.b[10][0]++,!config.allowAnonymous)&&(cov_linixbpzt.b[10][1]++,!config.allowAnonymousViews)){cov_linixbpzt.b[9][0]++;cov_linixbpzt.s[39]++;delete config.permission.freely;cov_linixbpzt.s[40]++;delete config.permission.editable;cov_linixbpzt.s[41]++;delete config.permission.locked;cov_linixbpzt.s[42]++;defaultPermission=config.permission.limited;}else{cov_linixbpzt.b[9][1]++;cov_linixbpzt.s[43]++;if((cov_linixbpzt.b[12][0]++,!config.allowAnonymous)&&(cov_linixbpzt.b[12][1]++,!config.allowAnonymousEdits)){cov_linixbpzt.b[11][0]++;cov_linixbpzt.s[44]++;delete config.permission.freely;}else{cov_linixbpzt.b[11][1]++;}}cov_linixbpzt.s[45]++;if(!(config.defaultPermission in config.permission)){cov_linixbpzt.b[13][0]++;cov_linixbpzt.s[46]++;config.defaultPermission=defaultPermission;}else{cov_linixbpzt.b[13][1]++;}// cache result, cannot change config in runtime!!!
cov_linixbpzt.s[47]++;config.isStandardHTTPsPort=function isStandardHTTPsPort(){cov_linixbpzt.f[0]++;cov_linixbpzt.s[48]++;return(cov_linixbpzt.b[14][0]++,config.useSSL)&&(cov_linixbpzt.b[14][1]++,config.port===443);}();cov_linixbpzt.s[49]++;config.isStandardHTTPPort=function isStandardHTTPPort(){cov_linixbpzt.f[1]++;cov_linixbpzt.s[50]++;return(cov_linixbpzt.b[15][0]++,!config.useSSL)&&(cov_linixbpzt.b[15][1]++,config.port===80);}();// cache serverURL
cov_linixbpzt.s[51]++;config.serverURL=function getserverurl(){cov_linixbpzt.f[2]++;var url=(cov_linixbpzt.s[52]++,'');cov_linixbpzt.s[53]++;if(config.domain){cov_linixbpzt.b[16][0]++;var protocol=(cov_linixbpzt.s[54]++,config.protocolUseSSL?(cov_linixbpzt.b[17][0]++,'https://'):(cov_linixbpzt.b[17][1]++,'http://'));cov_linixbpzt.s[55]++;url=protocol+config.domain;cov_linixbpzt.s[56]++;if(config.urlAddPort){cov_linixbpzt.b[18][0]++;cov_linixbpzt.s[57]++;if((cov_linixbpzt.b[20][0]++,!config.isStandardHTTPPort)||(cov_linixbpzt.b[20][1]++,!config.isStandardHTTPsPort)){cov_linixbpzt.b[19][0]++;cov_linixbpzt.s[58]++;url+=':'+config.port;}else{cov_linixbpzt.b[19][1]++;}}else{cov_linixbpzt.b[18][1]++;}}else{cov_linixbpzt.b[16][1]++;}cov_linixbpzt.s[59]++;if(config.urlPath){cov_linixbpzt.b[21][0]++;cov_linixbpzt.s[60]++;url+='/'+config.urlPath;}else{cov_linixbpzt.b[21][1]++;}cov_linixbpzt.s[61]++;return url;}();cov_linixbpzt.s[62]++;if(config.serverURL===''){cov_linixbpzt.b[22][0]++;cov_linixbpzt.s[63]++;logger.warn('Neither \'domain\' nor \'CMD_DOMAIN\' is configured. This can cause issues with various components.\nHint: Make sure \'protocolUseSSL\' and \'urlAddPort\' or \'CMD_PROTOCOL_USESSL\' and \'CMD_URL_ADDPORT\' are configured properly.');}else{cov_linixbpzt.b[22][1]++;}cov_linixbpzt.s[64]++;config.Environment=Environment;// auth method
cov_linixbpzt.s[65]++;config.isFacebookEnable=(cov_linixbpzt.b[23][0]++,config.facebook.clientID)&&(cov_linixbpzt.b[23][1]++,config.facebook.clientSecret);cov_linixbpzt.s[66]++;config.isGoogleEnable=(cov_linixbpzt.b[24][0]++,config.google.clientID)&&(cov_linixbpzt.b[24][1]++,config.google.clientSecret);cov_linixbpzt.s[67]++;config.isDropboxEnable=(cov_linixbpzt.b[25][0]++,config.dropbox.clientID)&&(cov_linixbpzt.b[25][1]++,config.dropbox.clientSecret);cov_linixbpzt.s[68]++;config.isTwitterEnable=(cov_linixbpzt.b[26][0]++,config.twitter.consumerKey)&&(cov_linixbpzt.b[26][1]++,config.twitter.consumerSecret);cov_linixbpzt.s[69]++;config.isEmailEnable=config.email;cov_linixbpzt.s[70]++;config.isOpenIDEnable=config.openID;cov_linixbpzt.s[71]++;config.isGitHubEnable=(cov_linixbpzt.b[27][0]++,config.github.clientID)&&(cov_linixbpzt.b[27][1]++,config.github.clientSecret);cov_linixbpzt.s[72]++;config.isBitbucketEnable=(cov_linixbpzt.b[28][0]++,config.bitbucket.clientID)&&(cov_linixbpzt.b[28][1]++,config.bitbucket.clientSecret);cov_linixbpzt.s[73]++;config.isGitLabEnable=(cov_linixbpzt.b[29][0]++,config.gitlab.clientID)&&(cov_linixbpzt.b[29][1]++,config.gitlab.clientSecret);cov_linixbpzt.s[74]++;config.isMattermostEnable=(cov_linixbpzt.b[30][0]++,config.mattermost.clientID)&&(cov_linixbpzt.b[30][1]++,config.mattermost.clientSecret);cov_linixbpzt.s[75]++;config.isLDAPEnable=config.ldap.url;cov_linixbpzt.s[76]++;config.isSAMLEnable=config.saml.idpSsoUrl;cov_linixbpzt.s[77]++;config.isOAuth2Enable=(cov_linixbpzt.b[31][0]++,config.oauth2.clientID)&&(cov_linixbpzt.b[31][1]++,config.oauth2.clientSecret);cov_linixbpzt.s[78]++;config.isPDFExportEnable=config.allowPDFExport;// Check gitlab api version
cov_linixbpzt.s[79]++;if((cov_linixbpzt.b[33][0]++,config.gitlab)&&(cov_linixbpzt.b[33][1]++,config.gitlab.version!=='v4')&&(cov_linixbpzt.b[33][2]++,config.gitlab.version!=='v3')){cov_linixbpzt.b[32][0]++;cov_linixbpzt.s[80]++;logger.warn('config.js contains wrong version ('+config.gitlab.version+') for gitlab api; it should be \'v3\' or \'v4\'. Defaulting to v4');cov_linixbpzt.s[81]++;config.gitlab.version='v4';}else{cov_linixbpzt.b[32][1]++;}// If gitlab scope is api, enable snippets Export/import
cov_linixbpzt.s[82]++;config.isGitlabSnippetsEnable=((cov_linixbpzt.b[34][0]++,!config.gitlab.scope)||(cov_linixbpzt.b[34][1]++,config.gitlab.scope==='api'))&&(cov_linixbpzt.b[34][2]++,config.isGitLabEnable);// Only update i18n files in development setups
cov_linixbpzt.s[83]++;config.updateI18nFiles=env===Environment.development;// merge legacy values
const keys=(cov_linixbpzt.s[84]++,Object.keys(config));const uppercase=(cov_linixbpzt.s[85]++,/[A-Z]/);cov_linixbpzt.s[86]++;for(let i=(cov_linixbpzt.s[87]++,keys.length);i--;){const lowercaseKey=(cov_linixbpzt.s[88]++,keys[i].toLowerCase());// if the config contains uppercase letters
// and a lowercase version of this setting exists
// and the config with uppercase is not set
// we set the new config using the old key.
cov_linixbpzt.s[89]++;if((cov_linixbpzt.b[36][0]++,uppercase.test(keys[i]))&&(cov_linixbpzt.b[36][1]++,config[lowercaseKey]!==undefined)&&(cov_linixbpzt.b[36][2]++,fileConfig[keys[i]]===undefined)){cov_linixbpzt.b[35][0]++;cov_linixbpzt.s[90]++;logger.warn('config.js contains deprecated lowercase setting for '+keys[i]+'. Please change your config.js file to replace '+lowercaseKey+' with '+keys[i]);cov_linixbpzt.s[91]++;config[keys[i]]=config[lowercaseKey];}else{cov_linixbpzt.b[35][1]++;}}// Notify users about the prefix change and inform them they use legacy prefix for environment variables
cov_linixbpzt.s[92]++;if(Object.keys(process.env).toString().indexOf('HMD_')!==-1){cov_linixbpzt.b[37][0]++;cov_linixbpzt.s[93]++;logger.warn('Using legacy HMD prefix for environment variables. Please change your variables in future. For details see: https://hackmd.io/c/codimd-documentation/%2F%40codimd%2Fmigrate-2-0#1-Drop-old-environment-variables-support');}else{cov_linixbpzt.b[37][1]++;}// Generate session secret if it stays on default values
cov_linixbpzt.s[94]++;if(config.sessionSecret==='secret'){cov_linixbpzt.b[38][0]++;cov_linixbpzt.s[95]++;logger.warn('Session secret not set. Using random generated one. Please set `sessionSecret` in your config.js file. All users will be logged out.');cov_linixbpzt.s[96]++;config.sessionSecret=crypto.randomBytes(Math.ceil(config.sessionSecretLen/2))// generate crypto graphic random number
.toString('hex')// convert to hexadecimal format
.slice(0,config.sessionSecretLen);// return required number of characters
}else{cov_linixbpzt.b[38][1]++;}// Validate upload upload providers
cov_linixbpzt.s[97]++;if(['filesystem','notable','s3','minio','imgur','azure','lutim'].indexOf(config.imageUploadType)===-1){cov_linixbpzt.b[39][0]++;cov_linixbpzt.s[98]++;logger.error('"imageuploadtype" is not correctly set. Please use "filesystem", "notable", "s3", "minio", "azure", "lutim" or "imgur". Defaulting to "filesystem"');cov_linixbpzt.s[99]++;config.imageUploadType='filesystem';}else{cov_linixbpzt.b[39][1]++;}// figure out mime types for image uploads
cov_linixbpzt.s[100]++;switch(config.imageUploadType){case'imgur':cov_linixbpzt.b[40][0]++;cov_linixbpzt.s[101]++;config.allowedUploadMimeTypes=['image/jpeg','image/png','image/jpg','image/gif'];cov_linixbpzt.s[102]++;break;default:cov_linixbpzt.b[40][1]++;cov_linixbpzt.s[103]++;config.allowedUploadMimeTypes=['image/jpeg','image/png','image/jpg','image/gif','image/svg+xml'];}// generate correct path
cov_linixbpzt.s[104]++;config.sslCAPath.forEach(function(capath,i,array){cov_linixbpzt.f[3]++;cov_linixbpzt.s[105]++;array[i]=path.resolve(appRootPath,capath);});cov_linixbpzt.s[106]++;config.appRootPath=appRootPath;cov_linixbpzt.s[107]++;config.sslCertPath=path.resolve(appRootPath,config.sslCertPath);cov_linixbpzt.s[108]++;config.sslKeyPath=path.resolve(appRootPath,config.sslKeyPath);cov_linixbpzt.s[109]++;config.dhParamPath=path.resolve(appRootPath,config.dhParamPath);cov_linixbpzt.s[110]++;config.viewPath=path.resolve(appRootPath,config.viewPath);cov_linixbpzt.s[111]++;config.tmpPath=path.resolve(appRootPath,config.tmpPath);cov_linixbpzt.s[112]++;config.defaultNotePath=path.resolve(appRootPath,config.defaultNotePath);cov_linixbpzt.s[113]++;config.docsPath=path.resolve(appRootPath,config.docsPath);cov_linixbpzt.s[114]++;config.uploadsPath=path.resolve(appRootPath,config.uploadsPath);// make config readonly
cov_linixbpzt.s[115]++;config=deepFreeze(config);cov_linixbpzt.s[116]++;module.exports=config;